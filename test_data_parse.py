"""测试数据解析修复"""
from Data.data_service import UnifiedDataService

print("测试数据解析...")

service = UnifiedDataService()

# 测试解析异常数据
bad_klines = [
    [1704067200000, "100", "105", "95", "102", "1000", 1704067499999, "102000", 500, "500", "51000", "0"],
    [1704067500000, "1483130.8998003995722.9514001377824.1036001108375.7897003006650.4585005465942.9069002602657.4169002104748.1452002205898.1677002812672.9485001600100.515100546074.441200862408.763200767509.911800652172.4910001847368.6669001851824.9042002716987.66180014319210.0729709781883.87330010327409.7371002693952.4929001804596.7518001767588.8174002301674.5417002208059.9910002109897.5517002648900.0480001719735.0802001509176.899600", "105", "95", "102", "1000", 1704067799999, "102000", 500, "500", "51000", "0"],
    [1704067800000, "102", "107", "97", "104", "1100", 1704068099999, "114400", 600, "550", "57200", "0"],
]

df = service._parse_klines(bad_klines)
print(f"解析结果: {len(df)} 条有效数据")
print(df)

print("\n✅ 数据解析修复测试完成")
